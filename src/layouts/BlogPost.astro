---
import BaseLayout from './BaseLayout.astro';

interface Props {
  title: string;
  date: Date;
  description?: string;
  tags?: string[];
  cover_image?: string;
}

const { title, date, description, tags = [], cover_image } = Astro.props;
const formattedDate = new Intl.DateTimeFormat('en-US', {
  year: 'numeric', month: 'long', day: 'numeric',
}).format(date);
---

<BaseLayout title={title} description={description}>
  <article class="max-w-3xl mx-auto px-4 py-16">
    <header class="mb-10">
      <div class="flex items-center gap-3 mb-4 flex-wrap">
        <time datetime={date.toISOString()} class="text-sm text-gray-400">{formattedDate}</time>
        {tags.map(tag => (
          <span class="text-xs bg-blue-50 text-blue-700 border border-blue-100 px-2 py-0.5 rounded-full">{tag}</span>
        ))}
      </div>
      <h1 class="text-4xl font-bold text-gray-900 leading-tight mb-4">{title}</h1>
      {description && <p class="text-xl text-gray-500 leading-relaxed">{description}</p>}
      {cover_image && (
        <img src={cover_image} alt={title} class="mt-8 w-full rounded-2xl object-cover max-h-80" />
      )}
    </header>
    <div class="prose prose-gray prose-lg max-w-none
      prose-headings:font-bold prose-headings:text-gray-900
      prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline
      prose-code:bg-gray-100 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-sm
      prose-pre:bg-gray-900 prose-pre:text-gray-100
      prose-img:rounded-xl prose-img:shadow-sm">
      <slot />
    </div>
    <!-- Newsletter signup -->
    <div class="mt-16 pt-8 border-t border-gray-100">
      <div class="bg-gray-50 rounded-2xl px-8 py-10 text-center">
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Enjoyed this post?</h3>
        <p class="text-gray-500 text-sm mb-6">Get new posts straight to your inbox. No spam, ever.</p>
        <!-- Update the form action to your newsletter service endpoint -->
        <!-- e.g. Buttondown: https://buttondown.email/api/emails/embed-subscribe/YOUR_USERNAME -->
        <!-- e.g. Mailchimp or Formspree: replace action="" with your endpoint URL -->
        <form action="" method="post" target="_blank" class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto">
          <input
            type="email"
            name="email"
            placeholder="your@email.com"
            required
            class="flex-1 px-4 py-2.5 rounded-lg border border-gray-200 text-sm focus:outline-none focus:border-blue-400 focus:ring-2 focus:ring-blue-100 bg-white"
          />
          <button
            type="submit"
            class="px-6 py-2.5 bg-gray-900 text-white text-sm font-medium rounded-lg hover:bg-gray-700 transition-colors whitespace-nowrap"
          >
            Subscribe
          </button>
        </form>
      </div>
    </div>
    <div class="mt-8">
      <a href="/" class="inline-flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors">
        &larr; Back to all posts
      </a>
    </div>
  </article>
</BaseLayout>
